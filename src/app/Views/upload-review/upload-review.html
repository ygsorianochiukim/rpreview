<div class="min-h-screen bg-cover bg-center px-4 md:px-6 lg:px-8 py-6" style="background-image: url('background.webp');">

  <!-- OCCUPANT STATUS MESSAGE -->
  <div class="max-w-3xl mx-auto text-center mt-6" *ngIf="occupantStatus !== 'valid'">
    <div class="bg-white text-red-600 rounded-lg p-4 mb-4 font-nunito">
      {{ occupantMessage }}
    </div>
  </div>




<div class="grid grid-cols-3 items-center mb-4">
  <!-- Left: can be empty or add something later -->
  <div></div>

  <!-- Center: Logo -->
  <div class="flex justify-center">
    <img src="logo.png" alt="Logo" class="h-8 sm:h-8 md:h-10 lg:h-12 w-auto">
  </div>

  <!-- Right: Language selector -->
  <div class="flex justify-end">
    <select [(ngModel)]="selectedLanguage"
            class="w-20 sm:w-24 border rounded p-2 font-nunito text-sm sm:text-base">
      <option value="en">English</option>
      <option value="tl">Tagalog</option>
      <option value="hil">Hiligaynon</option>
    </select>
  </div>
</div><br>


  
  <!-- OCCUPANT INFO -->
  <div *ngIf="!submitted" class="max-w-3xl mx-auto text-center mb-4 text-white font-nunito">
    <p><span class="font-semibold">Interred Name:</span> {{ occupantName }}</p>
    <p><span class="font-semibold">Date of Interment:</span> {{ intermentDate }}</p>
  </div>

  <!-- STEP HEADER -->
  <div *ngIf="!submitted" class="max-w-3xl mx-auto rounded-lg overflow-hidden mb-6">
    <h2 class="text-3xl font-bold text-white text-center font-nunito">
      {{ getHeaderText() }}
    </h2>
    <p class="text-white text-center font-nunito mt-2">
      {{ getSubHeaderText() }}
    </p>
  </div>

  <!-- FORM & STEPPER -->
  <form *ngIf="!submitted" [formGroup]="reviewForm" (ngSubmit)="submitReview()">
    <div class="max-w-3xl mx-auto bg-white rounded-lg p-6 shadow-md">

      <!-- STEP 1: REVIEWER INFO -->
      <div *ngIf="step === 1">
        <h3 class="font-semibold mb-3 text-dark font-nunito">Reviewer Information</h3>

        <label class="text-red-600">*</label>
        <input type="text" formControlName="reviewerName" placeholder="Your Name"
               class="w-full border rounded p-2 mb-3 font-nunito">
        <div *ngIf="reviewForm.get('reviewerName')?.touched && reviewForm.get('reviewerName')?.invalid"
             class="text-red-600 text-sm mb-2">
          Please input Name.
        </div>

        <label class="text-red-600">*</label>
        <input type="text" formControlName="contactNumber" placeholder="Contact Number"
               class="w-full border rounded p-2 mb-3 font-nunito">
        <div *ngIf="reviewForm.get('contactNumber')?.touched && reviewForm.get('contactNumber')?.invalid"
             class="text-red-600 text-sm mb-2">
          Please input Contact number.
        </div>

        <div class="flex justify-end mt-6">
          <button type="button" 
                  (click)="next()"
                  [disabled]="reviewForm.get('reviewerName')?.invalid || reviewForm.get('contactNumber')?.invalid"
                  class="bg-secondary py-2 px-6 rounded text-white font-semibold font-nunito hover:bg-brown-dark disabled:opacity-50 disabled:cursor-not-allowed">
            Next
          </button>
        </div>
      </div>

      <!-- STEP 2: PUBLIC REVIEW -->
      <div *ngIf="step === 2">
        <h3 class="font-semibold mb-3 text-dark font-nunito">Public Review</h3>

<div class="mb-4">
  <!-- Question line with reload button -->
  <div class="flex items-start justify-between gap-3">
    <p class="text-dark-700 font-bold font-nunito flex-1 min-w-0">
      {{ currentFocusQuestion }}
    </p>

    <!-- Reload button -->
    <button type="button"
            (click)="nextQuestion()"
            title="Change question"
            class="w-8 h-8 bg-no-repeat bg-center bg-contain hover:opacity-70"
            style="background-image: url('reload.png');">
    </button>
  </div>

  <!-- Select button under the question -->
  <div class="mt-2">
    <button type="button"
            (click)="selectQuestion(currentFocusQuestion)"
            [disabled]="selectedFocusQuestion === currentFocusQuestion"
            class="bg-primary-green text-white px-3 py-1 rounded hover:bg-green-600 disabled:bg-gray-300">
      {{ selectedFocusQuestion === currentFocusQuestion ? 'Selected' : 'Select' }}
    </button>
  </div>
</div>


        <p class="text-sm text-gray-500 font-nunito mb-3">
          This question helps us understand your experience better. Kindly keep your response related to it.
        </p>

        <!-- Facebook -->
        <label class="w-full inline-block bg-secondary text-white py-2 px-4 rounded cursor-pointer text-center font-nunito hover:bg-brown-dark mb-2">
          Upload Facebook Screenshot
          <input type="file" (change)="onFbChange($event)" class="hidden">
        </label>
        <div *ngIf="fbPreview" class="mt-2 mb-4">
          <div class="flex items-center gap-2">
            <img [src]="fbPreview" class="w-24 h-24 object-cover border rounded">

            <div class="flex flex-col sm:flex-row gap-2 mb-2">
              <label class="flex-1 bg-secondary text-white py-2 px-4 rounded cursor-pointer text-center font-nunito hover:bg-brown-dark">
                Change
                <input type="file" (change)="onFbChange($event)" class="hidden">
              </label>
              <button type="button" (click)="removeFb()" class="flex-1 bg-red-500 text-white py-2 px-4 rounded hover:bg-red-600">
                Remove
              </button>
            </div>
          </div>
        </div>

        <!-- Google -->
        <label class="w-full inline-block bg-secondary text-white py-2 px-4 rounded cursor-pointer text-center font-nunito hover:bg-brown-dark mb-4">
          {{ googlePreview ? 'Change Google Screenshot' : 'Upload Google Screenshot' }}
          <input type="file" (change)="onGoogleChange($event)" class="hidden">
        </label>
        <div *ngIf="googlePreview" class="mt-2 mb-4">
          <div class="flex items-center gap-2">
            <img [src]="googlePreview" class="w-24 h-24 object-cover border rounded">
            <div class="flex flex-col sm:flex-row gap-2 mb-4">
              <label class="flex-1 bg-secondary text-white py-2 px-4 rounded cursor-pointer text-center font-nunito hover:bg-brown-dark">
                Change
                <input type="file" (change)="onGoogleChange($event)" class="hidden">
              </label>
              <button type="button" (click)="removeGoogle()" class="flex-1 bg-red-500 text-white py-2 px-4 rounded hover:bg-red-600">
                Remove
              </button>
            </div>
          </div>
        </div>

        <div class="flex justify-between mt-6">
          <button type="button" (click)="back()" class="bg-gray-300 py-2 px-6 rounded text-dark font-semibold font-nunito hover:bg-gray-400">
            Back
          </button>
          <button type="button" (click)="next()"
                  [disabled]="!fbPreview && !googlePreview"
                  class="bg-secondary py-2 px-6 rounded text-white font-semibold font-nunito hover:bg-brown-dark disabled:opacity-50 disabled:cursor-not-allowed">
            Next
          </button>
        </div>
      </div>

      <!-- STEP 3: PRIVATE FEEDBACK -->
      <div *ngIf="step === 3">
        <h3 class="font-semibold mb-3 text-dark font-nunito">Private Feedback</h3>

        <div class="mb-4">
          <!-- Private FAQ line with reload button -->
          <div class="flex items-start justify-between gap-3">
            <p class="text-dark-700 font-bold font-nunito flex-1 min-w-0">
              {{ currentPrivateFaq }}
            </p>

            <!-- Reload button -->
            <button type="button"
                    (click)="nextPrivateFaq()"
                    title="Change question"
                    class="w-8 h-8 bg-no-repeat bg-center bg-contain hover:opacity-70"
                    style="background-image: url('reload.png');">
            </button>
          </div>

          <!-- Select button under the question -->
          <div class="mt-2">
            <button type="button"
                    (click)="selectPrivateFaq(currentPrivateFaq)"
                    [disabled]="selectedPrivateFaq === currentPrivateFaq"
                    class="bg-primary-green text-white px-3 py-1 rounded hover:bg-green-600 disabled:bg-gray-300">
              {{ selectedPrivateFaq === currentPrivateFaq ? 'Selected' : 'Select' }}
            </button>
          </div>
        </div>



        <p class="text-sm text-gray-500 font-nunito mb-3">
          This question helps us understand your experience better. Kindly keep your response related to it.
        </p>

        <textarea formControlName="privateFaqAnswer" rows="4" placeholder="Your answer here..."
                  class="w-full border rounded p-2 mb-3 font-nunito"></textarea>
          Any other suggestions...
        <textarea formControlName="privateOthers" rows="5" placeholder="Your answer here..."
                  class="w-full border rounded p-2 mb-3 font-nunito"></textarea>

        <div class="flex justify-between mt-6">
          <button type="button" (click)="back()" class="bg-gray-300 py-2 px-6 rounded text-dark font-semibold font-nunito hover:bg-gray-400">
            Back
          </button>
          <button type="submit" class="bg-secondary py-2 px-6 rounded text-white font-semibold font-nunito hover:bg-brown-dark">
            Submit
          </button>
        </div>
      </div>

    </div> <!-- END form container -->
  </form>

  <!-- THANK YOU MESSAGE -->
  <div *ngIf="submitted" class="max-w-3xl mx-auto bg-white rounded-lg p-6 shadow-md text-center">
    <h2 class="text-2xl font-bold text-dark font-nunito mb-4">Thank You!</h2>
    <p class="font-nunito mb-4">
      Your review has been successfully submitted. We appreciate your feedback.
    </p>
  </div>

</div>
